{"version":3,"sources":["webpack:///D:/user/Documents/HBuilderProjects/PovertySurvey/pages/formPage/formPage.vue?141f","webpack:///D:/user/Documents/HBuilderProjects/PovertySurvey/pages/formPage/formPage.vue?8ab5","uni-app:///main.js",null,"webpack:///D:/user/Documents/HBuilderProjects/PovertySurvey/pages/formPage/formPage.vue?617e","webpack:///D:/user/Documents/HBuilderProjects/PovertySurvey/pages/formPage/formPage.vue?58c9","webpack:///D:/user/Documents/HBuilderProjects/PovertySurvey/pages/formPage/formPage.vue?876f","uni-app:///pages/formPage/formPage.vue"],"names":["createPage","Page"],"mappings":";;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAszC,CAAgB,ktCAAG,EAAC,C;;;;;;;;;;;ACA10C;AACA,OAAO,KAAU,EAAE,kBAKd;;;;;;;;;;;;;kDCNL;AACA;AACA,qG;AACAA,UAAU,CAACC,iBAAD,CAAV,C;;;;;;;;;;;;;ACHA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAiI;AACjI;AAC4D;AACL;AACsC;;;AAG7F;AACuL;AACvL,gBAAgB,2LAAU;AAC1B,EAAE,8EAAM;AACR,EAAE,+FAAM;AACR,EAAE,wGAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,mGAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACjBA;AAAA;AAAA;AAAA;AAAysB,CAAgB,wrBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACoC7tB;AACA,sDADA;AAEA,MAFA,kBAEA;AACA;AACA,gBADA;AAEA,yBAFA;AAGA,sBAHA;AAIA,cAJA;AAKA,qBALA;AAMA,mBANA;AAOA,0BAPA;AAQA,gBARA;AASA,kBATA;AAUA,sBAVA,EAUA;AACA,4BAXA,EAWA;AACA,wBAZA,CAYA;AAZA;AAcA,GAjBA;AAkBA;AACA;AACA;AACA;AACA;AACA;AACA,OAHA,MAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAFA;AAGA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aALA;AAMA;AACA;AACA;AACA;AACA,OAnBA;AAoBA;AACA,KAxCA,EAlBA;;AA4DA,SA5DA,qBA4DA;;;;;;;AAOA,GAnEA;AAoEA,QApEA,kBAoEA,MApEA,EAoEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAHA,CAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAFA,MAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAVA,MAUA;AACA;AACA;AACA;AACA;AACA;AACA,SAFA,CAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAZA,MAYA;AACA;AACA,qBADA;AAEA,oBAFA;;AAIA;AACA,GApIA;;AAsIA;AACA,eADA,uBACA,CADA,EACA;AACA;AACA,6DADA;;AAGA,KALA;AAMA,oBANA,4BAMA,CANA,EAMA;AACA;AACA;AACA;AACA,KAVA;AAWA,cAXA,sBAWA,IAXA,EAWA;AACA,mBADA,GACA,+BADA;AAEA,mBAFA,GAEA,sDAFA;AAGA,wBAHA,GAGA,wBAHA;AAIA,gIAJA;AAKA,mBALA,GAKA;AACA,gDADA;AAEA,iCAFA;AAGA,kJAHA;AAIA,wCAJA;AAKA,mDALA;AAMA,2BANA,EALA;;AAaA,6CAbA,SAaA,GAbA;AAcA,4CAdA;AAeA,4DAfA;;AAiBA,8BAjBA;;;AAoBA,qBApBA;;AAsBA,KAjCA;AAkCA;AACA,mBADA,GACA,+BADA;AAEA,gFAFA,SAEA,KAFA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAHA;AAIA,mBALA;AAMA;AACA;AACA;AACA,kDADA;;AAGA;AACA;AACA,oBApBA,GAoBA,IApBA;AAqBA,yBArBA;AAsBA,wBAtBA;;;;AA0BA,qBA1BA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsEA,wBAtEA,yBA2BA,4CACA,8CACA,oDACA,2CACA,4BACA,uCACA,CACA,CAJA,EAKA,CANA,EAOA,CACA,2HACA,8EACA,GAFA,GAEA,EAFA,CAGA,+CACA,2CACA,oCACA,+BACA,yBACA,CACA,CALA,EAMA,CAPA,EAQA,CACA,4CACA,mCACA,2CACA,oCACA,6BACA,CACA,kEACA,oCACA,iEACA,yBACA,CACA,CAJA,EAKA,CACA,+BACA;AACA,uBACA,CAdA,EAeA,CAhBA,EAiBA,CACA,+BApEA,6CAuEA,iFAvEA,iPAlCA;;;;;;AA+GA,YA/GA,oBA+GA,CA/GA,EA+GA;AACA,mBADA,GACA,mCADA;AAEA;AACA;AACA;AACA;AACA,oCANA;AAOA,6BAPA;AAQA,sBARA;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmCA,wBAnCA;;;;;;;;;;;;;;;;;;;;;;;AA0DA,uBA1DA;;;;;;;;;;;;AAsEA,2BAtEA,wBASA,2BACA,CADA,MACA,CACA,UACA,kFACA,GAFA,GAEA,+BAFA,CAGA,GAHA,GAGA,gDAHA,CAIA,qEACA,0CACA,mCACA,mDACA,gCACA,gBACA,WADA,EAEA,eAFA,EAGA,iBAHA,EAIA,OAJA,mBAIA,GAJA,EAIA,CACA,kBACA,mBACA,CACA,CARA,IAUA,CACA,CAhBA,EAiBA,CACA,CAjCA,4CAoCA,+CApCA,KAqCA,GArCA,8BAsCA,qDACA,IAvCA,GAuCA,+BAvCA,CAwCA,IAxCA,GAwCA,iDAxCA,CAyCA,qBAzCA,2BA0CA,4BA1CA,SA0CA,IA1CA,kBA2CA,6BACA,oCACA,gBACA,WADA,EAEA,eAFA,EAGA,iBAHA,EAIA,OAJA,mBAIA,GAJA,EAIA,CACA,kBACA,mBACA,CACA,CARA,IAUA,CAvDA,qDA2DA,GA3DA,GA2DA,6BA3DA,CA4DA,UACA,gBACA,YADA,IAGA,CAJA,MAIA,CACA,gBACA,aADA,IAGA,CApEA;AAuEA,kDAvEA;AAwEA,qBAxEA,GAwEA,iEAxEA;AAyEA,oBAzEA,GAyEA;AACA;AACA,uCADA;AAEA,gDAFA;AAGA,uCAHA,EADA,CAzEA;;;AAgFA,gDAhFA,UAgFA,KAhFA;AAiFA;AACA;AACA,+BADA;AAEA,6EAFA;AAGA,qCAHA;AAIA,2BAJA,mBAIA,GAJA,EAIA;AACA;AACA;AACA;AACA,yBAFA,EAEA,IAFA;AAGA;AACA,qBAVA;;AAYA,iBAbA,MAaA;AACA;AACA,mDADA;AAEA,+BAFA;AAGA,gCAHA;;AAKA,iBApGA;;;;;;;;;;;;;AAiHA;AACA,sCADA,IAjHA;;;;AAsHA,KArOA;AAsOA,eAtOA,yBAsOA;AACA,uBADA,GACA,sCADA;AAEA,oBAFA,GAEA,6DAFA;AAGA,oBAHA,GAGA;AACA,oDADA;AAEA,iCAFA;AAGA;AACA;AACA,qCADA;AAEA,kCAFA;AAGA,kCAHA,EADA;;AAMA;AACA,0CADA;AAEA,kCAFA;AAGA,+BAHA,EANA;;AAWA;AACA,qCADA;AAEA,kCAFA;AAGA,+BAHA,EAXA;;;AAiBA;AApBA,iBAHA;AAyBA,+CAzBA,SAyBA,IAzBA;AA0BA,kDA1BA;AA2BA,iCA3BA;AA4BA,KAlQA,EAtIA,E","file":"pages/formPage/formPage.js","sourcesContent":["import mod from \"-!../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-2!../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./formPage.vue?vue&type=style&index=0&id=937dd034&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-2!../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./formPage.vue?vue&type=style&index=0&id=937dd034&lang=scss&scoped=true&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1596453810552\n      var cssReload = require(\"D:/Program Files/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"../../\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  ","import 'uni-pages';\nimport Vue from 'vue'\nimport Page from './pages/formPage/formPage.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./formPage.vue?vue&type=template&id=937dd034&scoped=true&\"\nvar renderjs\nimport script from \"./formPage.vue?vue&type=script&lang=js&\"\nexport * from \"./formPage.vue?vue&type=script&lang=js&\"\nimport style0 from \"./formPage.vue?vue&type=style&index=0&id=937dd034&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"937dd034\",\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/formPage/formPage.vue\"\nexport default component.exports","export * from \"-!../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--16-0!../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./formPage.vue?vue&type=template&id=937dd034&scoped=true&\"","var components\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  if (!_vm._isMounted) {\n    _vm.e0 = function($event) {\n      _vm.showSublist = !_vm.showSublist\n    }\n\n    _vm.e1 = function($event) {\n      _vm.showSublist = !_vm.showSublist\n    }\n  }\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./formPage.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./formPage.vue?vue&type=script&lang=js&\"","<template>\r\n\t<view>\r\n\t\t<bxform\r\n\t\t\t:service=\"serviceName\"\r\n\t\t\tref=\"bxForm\"\r\n\t\t\t:pageType=\"type\"\r\n\t\t\t:defaultCondition=\"defaultCondition\"\r\n\t\t\t:BxformType=\"type\"\r\n\t\t\t:fields=\"fields\"\r\n\t\t\t@changeFieldModel=\"changeFieldModel\"\r\n\t\t\t:moreConfig=\"colsV2Data && colsV2Data.more_config ? colsV2Data.more_config : null\"\r\n\t\t></bxform>\r\n\t\t<bxButtons :buttons=\"buttons\" @on-button-change=\"onButton($event)\" v-if=\"buttons && buttons.length > 0\"></bxButtons>\r\n\t\t<!-- <button class=\"bg-green cu-btn lg\">查看列表</button> -->\r\n\t\t<view class=\"sublist-content\">\r\n\t\t\t<!-- <view class=\"sublist-content\" v-if=\"type === 'detail'&&hasChildService\"> -->\r\n\t\t\t<view class=\"sublist-box\" v-if=\"showSublist\">\r\n\t\t\t\t<view class=\"child-service bg-blue\" v-for=\"item in childService\" :key=\"item.service_name\" @click=\"toChildList(item)\">\r\n\t\t\t\t\t{{ item.foreign_key.section_name }}({{ item.childData.data.length }})\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t\t<button class=\"cu-btn  bg-blue margin-tb-sm\" v-if=\"!showSublist&&hasChildService\" @click=\"showSublist = !showSublist\">\r\n\t\t\t\t展开子表\r\n\t\t\t\t<text class=\"lg text-white cuIcon-down margin-left-xs\"></text>\r\n\t\t\t</button>\r\n\t\t\t<button class=\"cu-btn  bg-blue margin-tb-sm\" v-if=\"showSublist\" @click=\"showSublist = !showSublist\">\r\n\t\t\t\t收起子表\r\n\t\t\t\t<text class=\"lg text-white cuIcon-top margin-left-xs\"></text>\r\n\t\t\t</button>\r\n\t\t</view>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\nimport bxform from '@/components/bx-form/bx-form.vue';\r\nimport bxButtons from '@/components/bx-buttons/bx-buttons.vue';\r\nexport default {\r\n\tcomponents: { bxform, bxButtons },\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\tfields: [],\r\n\t\t\tloadedType: 'srvV2',\r\n\t\t\tcolsV2Data: null,\r\n\t\t\ttype: '',\r\n\t\t\tserviceName: '',\r\n\t\t\tcondition: [],\r\n\t\t\tdefaultCondition: [],\r\n\t\t\tparams: {},\r\n\t\t\tformData: {},\r\n\t\t\tchildService: [], // 子表\r\n\t\t\thasChildService: false, //是否拥有子表\r\n\t\t\tshowSublist: false //显示子表\r\n\t\t};\r\n\t},\r\n\tcomputed: {\r\n\t\tbuttons: function() {\r\n\t\t\tlet buttons = [];\r\n\t\t\tif (this.colsV2Data && this.colsV2Data._buttonInfo) {\r\n\t\t\t\tbuttons = this.colsV2Data._buttonInfo;\r\n\t\t\t\t// return this.colsV2Data._buttonInfo;\r\n\t\t\t} else if (this.colsV2Data && this.colsV2Data._formButtons) {\r\n\t\t\t\tbuttons = this.colsV2Data._formButtons;\r\n\t\t\t\t// return this.colsV2Data._formButtons;\r\n\t\t\t}\r\n\t\t\tlet data = {};\r\n\t\t\tif (Array.isArray(this.fields)) {\r\n\t\t\t\tthis.fields.forEach(item => {\r\n\t\t\t\t\tdata[item['column']] = item['value'];\r\n\t\t\t\t});\r\n\t\t\t\tlet fieldModel = data;\r\n\t\t\t\tconsole.log(data, 'getDetailfieldModel');\r\n\t\t\t}\r\n\r\n\t\t\tbuttons.forEach(btn => {\r\n\t\t\t\tif (btn.disp_exps) {\r\n\t\t\t\t\tbtn['display'] = eval(btn.disp_exps);\r\n\t\t\t\t}\r\n\t\t\t\tif (btn.operate_params) {\r\n\t\t\t\t\tlet fieldData = btn.operate_params['data'];\r\n\t\t\t\t\tif (fieldData && Array.isArray(fieldData) && fieldData.length > 0) {\r\n\t\t\t\t\t\tfieldData = fieldData[0];\r\n\t\t\t\t\t\tlet newData = {};\r\n\t\t\t\t\t\tObject.keys(fieldData).forEach(data_item => {\r\n\t\t\t\t\t\t\tlet item = fieldData[data_item];\r\n\t\t\t\t\t\t\tif (item.value_type && item.value_type === 'rowData') {\r\n\t\t\t\t\t\t\t\tnewData[data_item] = fieldModel[item.value_key];\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tbtn['requestData'] = newData;\r\n\t\t\t\t\t\tbtn['requestCondition'] = this.condition;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\treturn buttons;\r\n\t\t}\r\n\t},\r\n\tcreated() {\r\n\t\t// #ifdef H5\r\n\t\tconst destApp = this.$route.query.destApp;\r\n\t\tif (destApp) {\r\n\t\t\tuni.setStorageSync('activeApp', destApp);\r\n\t\t}\r\n\t\t// #endif\r\n\t},\r\n\tonLoad(option) {\r\n\t\tlet query = JSON.parse(decodeURIComponent(option.query ? option.query : option.params ? option.params : '{}'));\r\n\t\tconsole.log('---------', option);\r\n\t\tconst destApp = query.destApp;\r\n\t\tif (destApp) {\r\n\t\t\tuni.setStorageSync('activeApp', destApp);\r\n\t\t}\r\n\t\tif (option.serviceName) {\r\n\t\t\tquery = option;\r\n\t\t}\r\n\t\tif (query.params) {\r\n\t\t\tthis.params = JSON.parse(query.params);\r\n\t\t}\r\n\t\tif (query.formData) {\r\n\t\t\ttry {\r\n\t\t\t\tthis.formData = JSON.parse(decodeURIComponent(query.formData));\r\n\t\t\t\tconsole.log('formData-formPage', this.formData);\r\n\t\t\t} catch (e) {\r\n\t\t\t\tconsole.log('formData', e);\r\n\t\t\t\t//TODO handle the exception\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (option.params) {\r\n\t\t\tthis.params = query;\r\n\t\t}\r\n\t\tif (query.cond || query.condition) {\r\n\t\t\tlet cond = '';\r\n\t\t\tif (typeof query.cond === 'string' && query.cond) {\r\n\t\t\t\tcond = JSON.parse(query.cond);\r\n\t\t\t}\r\n\t\t\tif (typeof query.condition === 'object') {\r\n\t\t\t\tcond = query.condition;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (option.hasOwnProperty('loadedType')) {\r\n\t\t\tthis.loadedType = option.loadedType;\r\n\t\t} else if (option.hasOwnProperty('params')) {\r\n\t\t\tthis.serviceName = this.params.serviceName;\r\n\t\t\tthis.type = this.params.type;\r\n\t\t\tthis.condition = this.params.condition;\r\n\t\t\tthis.defaultVal = this.params.defaultVal;\r\n\t\t\tlet cond = [];\r\n\t\t\tif (this.params.cond && Array.isArray(this.params.cond)) {\r\n\t\t\t\tcond = this.params.cond;\r\n\t\t\t}\r\n\t\t\tthis.getFieldsV2(cond);\r\n\t\t} else if (query.serviceName && query.type) {\r\n\t\t\tthis.serviceName = query.serviceName;\r\n\t\t\tthis.type = query.type;\r\n\t\t\tif (option.hasOwnProperty('cond')) {\r\n\t\t\t\ttry {\r\n\t\t\t\t\tthis.condition = JSON.parse(decodeURIComponent(option.cond));\r\n\t\t\t\t} catch (e) {\r\n\t\t\t\t\t//TODO handle the exception\r\n\t\t\t\t\tconsole.log(e);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.getFieldsV2();\r\n\t\t} else {\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle: '加载错误',\r\n\t\t\t\ticon: 'none'\r\n\t\t\t});\r\n\t\t}\r\n\t},\r\n\r\n\tmethods: {\r\n\t\ttoChildList(e) {\r\n\t\t\tuni.navigateTo({\r\n\t\t\t\turl: '/pages/list/list?serviceName=' + e.service_name\r\n\t\t\t});\r\n\t\t},\r\n\t\tchangeFieldModel(e) {\r\n\t\t\tif (e) {\r\n\t\t\t\tthis.formData = this.deepClone(e);\r\n\t\t\t}\r\n\t\t},\r\n\t\tasync selectList(item) {\r\n\t\t\tlet app = uni.getStorageSync('activeApp');\r\n\t\t\tlet url = this.getServiceUrl(app, item.service_name, 'select');\r\n\t\t\tlet formData = this.params.defaultVal;\r\n\t\t\tif (item.foreign_key && item.foreign_key.referenced_column_name && formData[item.foreign_key.referenced_column_name]) {\r\n\t\t\t\tlet req = {\r\n\t\t\t\t\tserviceName: item.service_name,\r\n\t\t\t\t\tcolNames: ['*'],\r\n\t\t\t\t\tcondition: [{ colName: item.foreign_key.column_name, ruleType: 'eq', value: formData[item.foreign_key.referenced_column_name] }],\r\n\t\t\t\t\trelation_condition: {},\r\n\t\t\t\t\tpage: { pageNo: 1, rownumber: 5 },\r\n\t\t\t\t\torder: []\r\n\t\t\t\t};\r\n\t\t\t\tlet res = await this.$http.post(url, req);\r\n\t\t\t\tif (res.data.state === 'SUCCESS') {\r\n\t\t\t\t\treturn { data: res.data.data, page: res.data.page };\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn res.data.state;\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t},\r\n\t\tgetFieldsV2: async function(condition) {\r\n\t\t\tlet app = uni.getStorageSync('activeApp');\r\n\t\t\tlet colVs = await this.getServiceV2(this.serviceName, this.type, this.type, app);\r\n\t\t\tif (colVs.child_service && Array.isArray(colVs.child_service) && colVs.child_service.length > 0) {\r\n\t\t\t\t// 有子表\r\n\t\t\t\tthis.hasChildService = true;\r\n\t\t\t\tthis.childService = colVs.child_service;\r\n\t\t\t\tthis.childService.forEach((item, index) => {\r\n\t\t\t\t\tthis.selectList(item).then(res => {\r\n\t\t\t\t\t\titem.childData = res;\r\n\t\t\t\t\t\tthis.$set(this.childService, index, item);\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tif (!this.navigationBarTitle) {\r\n\t\t\t\tuni.setNavigationBarTitle({\r\n\t\t\t\t\ttitle: colVs.service_view_name\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tthis.colsV2Data = colVs;\r\n\t\t\tlet self = this;\r\n\t\t\tswitch (this.type) {\r\n\t\t\t\tcase 'update':\r\n\t\t\t\t//\r\n\t\t\t\t//       this.fields = this.setFieldsDefaultVal(colVs._fieldInfo, this.params.defaultVal);\r\n\t\t\t\t//       break;\r\n\t\t\t\tcase 'add':\r\n\t\t\t\t\tconsole.log(this.formData, 'this.formData');\r\n\t\t\t\t\tif (Object.values(this.formData).length > 0) {\r\n\t\t\t\t\t\tObject.keys(this.formData).forEach(item => {\r\n\t\t\t\t\t\t\tcolVs._fieldInfo.forEach(field => {\r\n\t\t\t\t\t\t\t\tif (item === field.column) {\r\n\t\t\t\t\t\t\t\t\tfield['value'] = this.formData[item];\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (this.defaultCondition && Array.isArray(this.defaultCondition) && colVs._fieldInfo && Array.isArray(colVs._fieldInfo)) {\r\n\t\t\t\t\t\tconsole.log('this.defaultCondition', this.defaultCondition, colVs._fieldInfo);\r\n\t\t\t\t\t\tlet arr = [];\r\n\t\t\t\t\t\tthis.defaultCondition.forEach(cond => {\r\n\t\t\t\t\t\t\tcolVs._fieldInfo.forEach(field => {\r\n\t\t\t\t\t\t\t\tif (cond.colName === field.column) {\r\n\t\t\t\t\t\t\t\t\tfield['value'] = cond['value'];\r\n\t\t\t\t\t\t\t\t\tfield['disabled'] = true;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (condition && Array.isArray(condition)) {\r\n\t\t\t\t\t\tcondition.forEach(item => {\r\n\t\t\t\t\t\t\tcolVs._fieldInfo.forEach(field => {\r\n\t\t\t\t\t\t\t\tif (field.column === item.colName) {\r\n\t\t\t\t\t\t\t\t\tfield.condition = item.value;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif (typeof item.value !== 'string' && Array.isArray(item.value)) {\r\n\t\t\t\t\t\t\t\t\titem.value.forEach(cond => {\r\n\t\t\t\t\t\t\t\t\t\tif (cond.colName === cond.value && field.column === cond.value) {\r\n\t\t\t\t\t\t\t\t\t\t\tfield['display'] = false;\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif (this.params.defaultVal) {\r\n\t\t\t\t\t\t\t\t\t// 赋默认值\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.fields = colVs._fieldInfo;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'detail':\r\n\t\t\t\t\tthis.fields = this.setFieldsDefaultVal(colVs._fieldInfo, this.params.defaultVal);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t},\r\n\t\tasync onButton(e) {\r\n\t\t\tlet req = this.$refs.bxForm.getFieldModel();\r\n\t\t\tconsole.log(this.condition);\r\n\t\t\tif ((e.service_name == 'srvzhxq_syrk_wuye_add' || e.service_name == 'srvzhxq_syrk_add') && (!req.proc_status || req.proc_status != '完成') && req) {\r\n\t\t\t\treq.proc_status = '完成';\r\n\t\t\t}\r\n\t\t\tconsole.log(e, req);\r\n\t\t\tswitch (e.button_type) {\r\n\t\t\t\tcase 'edit':\r\n\t\t\t\t\tif (e.page_type === '详情') {\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tif (req) {\r\n\t\t\t\t\t\t\treq = [{ serviceName: e.service_name, data: [req], condition: this.condition }];\r\n\t\t\t\t\t\t\tlet app = uni.getStorageSync('activeApp');\r\n\t\t\t\t\t\t\tlet url = this.getServiceUrl(app, e.service_name, 'add');\r\n\t\t\t\t\t\t\tthis.onRequest('update', e.service_name, req).then(res => {\r\n\t\t\t\t\t\t\t\tconsole.log('res:' + e.service_name, res);\r\n\t\t\t\t\t\t\t\tif (res.data.state === 'SUCCESS') {\r\n\t\t\t\t\t\t\t\t\tlet resData = this.getResData(res.data.response);\r\n\t\t\t\t\t\t\t\t\tconsole.log('resData', resData);\r\n\t\t\t\t\t\t\t\t\tuni.showModal({\r\n\t\t\t\t\t\t\t\t\t\ttitle: '提示',\r\n\t\t\t\t\t\t\t\t\t\tcontent: '修改成功',\r\n\t\t\t\t\t\t\t\t\t\tshowCancel: false,\r\n\t\t\t\t\t\t\t\t\t\tsuccess(res) {\r\n\t\t\t\t\t\t\t\t\t\t\tif (res.confirm) {\r\n\t\t\t\t\t\t\t\t\t\t\t\tuni.navigateBack();\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'submit':\r\n\t\t\t\t\tconsole.log('addServiceName:', e.service_name);\r\n\t\t\t\t\tif (req) {\r\n\t\t\t\t\t\treq = [{ serviceName: e.service_name, data: [req] }];\r\n\t\t\t\t\t\tlet app = uni.getStorageSync('activeApp');\r\n\t\t\t\t\t\tlet url = this.getServiceUrl(app, e.service_name, 'add');\r\n\t\t\t\t\t\tconsole.log(url, e);\r\n\t\t\t\t\t\tlet res = await this.$http.post(url, req);\r\n\t\t\t\t\t\tconsole.log(url, res.data);\r\n\t\t\t\t\t\tif (res.data.state === 'SUCCESS') {\r\n\t\t\t\t\t\t\tuni.showModal({\r\n\t\t\t\t\t\t\t\ttitle: '提示',\r\n\t\t\t\t\t\t\t\tcontent: '添加成功',\r\n\t\t\t\t\t\t\t\tshowCancel: false,\r\n\t\t\t\t\t\t\t\tsuccess(res) {\r\n\t\t\t\t\t\t\t\t\tif (res.confirm) {\r\n\t\t\t\t\t\t\t\t\t\tuni.navigateBack();\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'reset':\r\n\t\t\t\t\tlet res = this.$refs.bxForm.onReset();\r\n\t\t\t\t\tif (res) {\r\n\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\ttitle: '已重置'\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\ttitle: '无效操作'\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'customize':\r\n\t\t\t\t\tif (e.application && e.operate_service) {\r\n\t\t\t\t\t\tconst url = this.getServiceUrl(e.application, e.operate_service, 'operate');\r\n\t\t\t\t\t\tconst req = [\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tdata: [e.requestData],\r\n\t\t\t\t\t\t\t\tserviceName: e.operate_service,\r\n\t\t\t\t\t\t\t\tsrvApp: e.application\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t];\r\n\t\t\t\t\t\tlet res = await this.$http.post(url, req);\r\n\t\t\t\t\t\tif (res.data.state === 'SUCCESS') {\r\n\t\t\t\t\t\t\tuni.showModal({\r\n\t\t\t\t\t\t\t\ttitle: '提示',\r\n\t\t\t\t\t\t\t\tcontent: e.tip_msg ? e.tip_msg : res.data.resultMessage,\r\n\t\t\t\t\t\t\t\tshowCancel: false,\r\n\t\t\t\t\t\t\t\tsuccess(res) {\r\n\t\t\t\t\t\t\t\t\tif (res.confirm) {\r\n\t\t\t\t\t\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\t\t\t\t\t\tuni.navigateBack();\r\n\t\t\t\t\t\t\t\t\t\t}, 2000);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\ttitle: res.data.resultMessage,\r\n\t\t\t\t\t\t\t\tmask: false,\r\n\t\t\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// const url = this.getServiceUrl(e.application, e.operate_service, 'operate');\r\n\t\t\t\t\t// const req = [\r\n\t\t\t\t\t//   {\r\n\t\t\t\t\t//     data: [e.requestData],\r\n\t\t\t\t\t//     serviceName: e.operate_service,\r\n\t\t\t\t\t//     srvApp: e.application\r\n\t\t\t\t\t//   }\r\n\t\t\t\t\t// ];\r\n\t\t\t\t\t// let res = await this.$http.post(url, req);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: e.button_name\r\n\t\t\t\t\t});\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t},\r\n\t\tasync getUserInfo() {\r\n\t\t\tlet user_no = uni.getStorageSync('basics_info').picp;\r\n\t\t\tlet urls = this.getServiceUrl('zhxq', 'srvzhxq_syrk_select', 'select');\r\n\t\t\tlet reqs = {\r\n\t\t\t\tserviceName: 'srvzhxq_syrk_select',\r\n\t\t\t\tcolNames: ['*'],\r\n\t\t\t\tcondition: [\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tcolName: 'gmsfhm',\r\n\t\t\t\t\t\truleType: 'eq',\r\n\t\t\t\t\t\tvalue: user_no\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tcolName: 'proc_status',\r\n\t\t\t\t\t\truleType: 'eq',\r\n\t\t\t\t\t\tvalue: '完成'\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tcolName: 'status',\r\n\t\t\t\t\t\truleType: 'eq',\r\n\t\t\t\t\t\tvalue: '有效'\r\n\t\t\t\t\t}\r\n\t\t\t\t]\r\n\t\t\t\t// order: [{ colName: 'seq', orderType: 'asc' }] ,\r\n\t\t\t};\r\n\t\t\tlet ress = await this.$http.post(urls, reqs);\r\n\t\t\tconsole.log('------------', ress);\r\n\t\t\treturn ress.data.data[0];\r\n\t\t}\r\n\t}\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.sublist-content {\r\n\tdisplay: flex;\r\n\tflex-direction: column;\r\n\tjustify-content: center;\r\n\talign-items: center;\r\n\tmargin: 50rpx 20rpx 0;\r\n\t.sublist-box {\r\n\t\twidth: 100%;\r\n\t\tdisplay: flex;\r\n\t\tborder: 1px dashed #efefef;\r\n\t\tjustify-content: space-around;\r\n\t\tpadding: 30rpx 20rpx;\r\n\t\t.child-service {\r\n\t\t\twidth: 50%;\r\n\t\t\theight: 80rpx;\r\n\t\t\tdisplay: flex;\r\n\t\t\tjustify-content: center;\r\n\t\t\talign-items: center;\r\n\t\t\tborder-radius: 10rpx;\r\n\t\t\tmargin: 10rpx;\r\n\t\t\ttext-align: center;\r\n\t\t}\r\n\t}\r\n}\r\n</style>\n"],"sourceRoot":""}