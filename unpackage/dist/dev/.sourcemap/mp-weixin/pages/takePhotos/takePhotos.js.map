{"version":3,"sources":["uni-app:///main.js","webpack:///D:/user/Documents/HBuilderProjects/PovertySurvey/pages/takePhotos/takePhotos.vue?3de3","webpack:///D:/user/Documents/HBuilderProjects/PovertySurvey/pages/takePhotos/takePhotos.vue?008a","webpack:///D:/user/Documents/HBuilderProjects/PovertySurvey/pages/takePhotos/takePhotos.vue?0f8e","webpack:///D:/user/Documents/HBuilderProjects/PovertySurvey/pages/takePhotos/takePhotos.vue?ddab","uni-app:///pages/takePhotos/takePhotos.vue","webpack:///D:/user/Documents/HBuilderProjects/PovertySurvey/pages/takePhotos/takePhotos.vue?dd04","webpack:///D:/user/Documents/HBuilderProjects/PovertySurvey/pages/takePhotos/takePhotos.vue?4539"],"names":["createPage","Page"],"mappings":";;;;;;;;;;kDAAA;AACA;AACA,2G;AACAA,UAAU,CAACC,mBAAD,CAAV,C;;;;;;;;;;;;;ACHA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAuH;AACvH;AAC8D;AACL;AACc;;;AAGvE;AACuL;AACvL,gBAAgB,2LAAU;AAC1B,EAAE,gFAAM;AACR,EAAE,qFAAM;AACR,EAAE,8FAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,yFAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACRA;AAAA;AAAA;AAAA;AAA2sB,CAAgB,0rBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC8D/tB;AACA,2BADA;AAEA,oDAFA;AAGA,MAHA,kBAGA;AACA;AACA,iBADA;AAEA,sBAFA;AAGA,sBAHA;AAIA,mBAJA;AAKA,oBALA;AAMA,qBANA,EAMA;AACA,kBAPA,EAOA;AACA,kBARA;AASA,iBATA;AAUA,sBAVA;AAWA,iBAXA;AAYA;AACA,gBADA;AAEA,wBAFA;AAGA,sBAHA;AAIA,2BAJA;AAKA,qBALA;AAMA,kBANA,EAZA;;AAoBA,qBApBA;AAqBA,sBArBA;;AAuBA,GA3BA;AA4BA,QA5BA,kBA4BA,MA5BA,EA4BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAFA;AAGA;AACA,OAbA,CAaA;AACA;AACA;AACA;AACA;AACA;AACA,KAFA,MAEA;AACA;AACA;AACA,GAvDA;AAwDA;AACA,UADA,oBACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8IADA;;AAGA;AACA,KAbA;AAcA,iBAdA,2BAcA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBADA;AAEA,gBAFA;AAGA,sBAHA;AAIA,wBAJA;AAKA;AACA;AACA,0BAPA;AAQA,4BARA;AASA,2BATA;AAUA,wCAVA;AAWA;AACA;AACA;AACA;AACA;AACA,8BADA;AAEA,0CAFA;AAGA,4BAHA;AAIA;AACA,8GADA,EAJA;;AAOA;AACA,mDADA;AAEA,sCAFA;AAGA,+BAHA;AAIA,+CAJA;AAKA,sCALA,EAPA;;AAcA;AACA;AACA;AACA,iBAjBA;;AAmBA,aAlCA;;AAoCA,SAxCA;AAyCA,OAjDA,MAiDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBADA;AAEA,gBAFA;AAGA,sBAHA;AAIA,uBAJA;AAKA,0BALA;AAMA,2BANA;AAOA,2BAPA;AAQA,qCARA;AASA;AACA;AACA;AACA;AACA;AACA,8BADA;AAEA,0CAFA;AAGA,4BAHA;AAIA;AACA,8GADA,EAJA;;AAOA;AACA,mDADA;AAEA,sCAFA;AAGA,+BAHA;AAIA,gCAJA;AAKA,+EALA,EAPA;;AAcA;AACA;AACA;AACA;AACA,iBAlBA;;AAoBA,aAjCA;;AAmCA,SAvCA;AAwCA;AACA,KApHA;AAqHA,cArHA,wBAqHA;AACA;AACA,wBADA;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBADA;AAEA,sBAFA;AAGA,6BAHA;AAIA,yBAJA;;AAMA;AACA,SARA;AASA;AACA;AACA;AACA;AACA;AACA,sBADA;AAEA,uBAFA;AAGA,+BAHA;AAIA,2BAJA;;AAMA;AACA,SARA;AASA;AACA;AACA;AACA;AACA;AACA;AACA,sBADA;AAEA,sBAFA;AAGA,8BAHA;AAIA,2BAJA;;AAMA;AACA,SARA;AASA;AACA;AACA;AACA;AACA;AACA,sBADA;AAEA,sBAFA;AAGA,6BAHA;AAIA,yBAJA;;;AAOA;AACA,SATA;AAUA,OAnDA,MAmDA;AACA;AACA;AACA;AACA;AACA;AACA,sBADA;AAEA,uBAFA;AAGA,+BAHA;AAIA,2BAJA;;AAMA;AACA,SARA;AASA;AACA,KA5LA;AA6LA,UA7LA,kBA6LA,UA7LA,EA6LA;AACA;AACA;AACA;AACA,YADA;AAEA,YAFA;AAGA,+BAHA;AAIA,iCAJA;AAKA,mCALA;AAMA,qCANA;AAOA,+BAPA;AAQA;AACA;AACA;AACA;AACA;AACA,0BADA;AAEA,sCAFA;AAGA,wBAHA;AAIA;AACA,0GADA,EAJA;;AAOA;AACA,+CADA;AAEA,kCAFA;AAGA,2BAHA;AAIA,4BAJA;AAKA,yBALA,EAPA;;AAcA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAJA,MAIA;AACA;AACA;AACA,uCADA;AAEA,yCAFA;AAGA,6BAHA;;AAKA;AACA;AACA;AACA,2DADA;AAEA;AACA;AACA,yCADA,EADA,CAFA,EADA;;;;;AAUA;AACA;AACA;AACA;AACA,kEAFA,CAEA;AACA;AACA;AACA,0BADA;AAEA,4BAFA;AAGA,mCAHA;AAIA,uCAJA;AAKA,2DALA;AAMA,6DANA;AAOA,2DAPA;;AASA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBATA;AAUA;AACA;AACA;AACA,mBA1BA,MA0BA;AACA;AACA;AACA,iBA/BA;AAgCA;AACA,aAxEA;;AA0EA,SAtFA;;AAwFA,KAxRA;AAyRA,YAzRA,sBAyRA;AACA;AACA,gBADA;AAEA,wBAFA;AAGA,sBAHA;;AAKA;AACA,KAhSA;AAiSA,aAjSA,uBAiSA;AACA;AACA;;;;;;;;;;;;;;AAcA;AACA;AACA;AACA,uBADA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,SARA;;;AAWA,KA9TA;AA+TA,SA/TA,iBA+TA,CA/TA,EA+TA;AACA;AACA,KAjUA,EAxDA,E;;;;;;;;;;;;;AC9DA;AAAA;AAAA;AAAA;AAAgyC,CAAgB,4rCAAG,EAAC,C;;;;;;;;;;;ACApzC;AACA,OAAO,KAAU,EAAE,kBAKd","file":"pages/takePhotos/takePhotos.js","sourcesContent":["import 'uni-pages';\nimport Vue from 'vue'\nimport Page from './pages/takePhotos/takePhotos.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./takePhotos.vue?vue&type=template&id=14f6ee46&\"\nvar renderjs\nimport script from \"./takePhotos.vue?vue&type=script&lang=js&\"\nexport * from \"./takePhotos.vue?vue&type=script&lang=js&\"\nimport style0 from \"./takePhotos.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/takePhotos/takePhotos.vue\"\nexport default component.exports","export * from \"-!../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--16-0!../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./takePhotos.vue?vue&type=template&id=14f6ee46&\"","var components\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./takePhotos.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./takePhotos.vue?vue&type=script&lang=js&\"","<template>\n\t<view class=\"collect-wrap\">\n\t\t<view class=\"camera-wrap\" v-if=\"showCamera\">\n\t\t\t<!-- <view class=\"collect-title\" v-if=\"!showCamera\">照片预览</view> -->\n\t\t\t<!-- #ifdef APP-PLUS||MP-WEIXIN -->\n\t\t\t<camera device-position=\"back\" flash=\"auto\" @error=\"error\" style=\"width:750upx; height: 1115upx\">\n\t\t\t\t<cover-image :src=\"addType === 'car' ? '../../static/img/car-horizonal.png' : '../../static/img/idcard-vertical.png'\" class=\"scan-img\"></cover-image>\n\t\t\t</camera>\n\t\t\t<view class=\"take-photo-box\"><image src=\"../../static/img/bd_ocr_take_photo_normal.png\" @click=\"takePhoto\" class=\"take-photo\"></image></view>\n\t\t\t<!-- #endif -->\n\n\t\t\t<!-- #ifdef H5 -->\n\t\t\t<view class=\"collect-button\"><button type=\"primary\" @click=\"takePhoto\">从相册选择照片</button></view>\n\t\t\t<!-- #endif -->\n\t\t</view>\n\t\t<view class=\"collect-box\" v-if=\"!showCamera\">\n\t\t\t<view class=\"image-box\">\n\t\t\t\t<image src=\"../../static/img/idcard-horizonal.png\" mode=\"\" class=\"image\" v-if=\"addType === 'person'\"></image>\n\t\t\t\t<image src=\"../../static/img/car-horizonal.png\" mode=\"\" class=\"image carPreviewImg\" v-if=\"addType === 'car'\"></image>\n\t\t\t\t<image :src=\"previewImg\" mode=\"aspectFit\" class=\"image previewImg\"></image>\n\t\t\t\t<!-- <image :src=\"previewImg\" mode=\"aspectFit\" class=\"image previewImg\" v-if=\"addType==='car'\"></image> -->\n\t\t\t</view>\n\t\t\t<view class=\"collect-button\">\n\t\t\t\t<button type=\"primary\" @click=\"clipImages\">识别文字</button>\n\t\t\t\t<button type=\"primary\" @click=\"toCarema\">重新拍照</button>\n\t\t\t</view>\n\t\t\t<form v-if=\"addType === 'car'\">\n\t\t\t\t<view class=\"cu-form-group margin-top\">\n\t\t\t\t\t<view class=\"title\">车牌号</view>\n\t\t\t\t\t<input placeholder=\"车牌号\" name=\"input\" v-model=\"formData.car_no\" />\n\t\t\t\t</view>\n\t\t\t</form>\n\t\t\t<form v-if=\"addType === 'person'\">\n\t\t\t\t<view class=\"cu-form-group margin-top\">\n\t\t\t\t\t<view class=\"title\">姓名</view>\n\t\t\t\t\t<input placeholder=\"姓名\" name=\"input\" v-model=\"formData.name\" />\n\t\t\t\t</view>\n\t\t\t\t<view class=\"cu-form-group margin-top\">\n\t\t\t\t\t<view class=\"title\">地址</view>\n\t\t\t\t\t<input placeholder=\"地址\" name=\"input\" v-model=\"formData.native\" />\n\t\t\t\t</view>\n\t\t\t\t<view class=\"cu-form-group margin-top\">\n\t\t\t\t\t<view class=\"title\">身份证号</view>\n\t\t\t\t\t<input placeholder=\"身份证号\" name=\"input\" v-model=\"formData.idNo\" />\n\t\t\t\t</view>\n\t\t\t</form>\n\t\t\t<button type=\"primary\" @click=\"toForm\">下一步</button>\n\t\t\t<canvas style=\"width: 688px; height:1024px;position:fixed;top:99999999999999upx;\" canvas-id=\"previewCarCanvas\"></canvas>\n\t\t\t<canvas style=\"width:110px; height: 145px;position:fixed;top:99999999999999upx;\" canvas-id=\"profileCanvas\"></canvas>\n\t\t\t<canvas style=\"width: 375px; height: 250px;position:fixed;top:99999999999999upx;\" canvas-id=\"previewCanvas\"></canvas>\n\t\t\t<canvas style=\"width: 160px; height: 35px;position:fixed;top:99999999999999upx;\" canvas-id=\"firstCanvas\"></canvas>\n\t\t\t<canvas style=\"width:170px; height: 70px;position:fixed;top:99999999999999upx;\" canvas-id=\"secondCanvas\"></canvas>\n\t\t\t<canvas style=\"width: 235px; height: 40px;position:fixed;top:99999999999999upx;\" canvas-id=\"thirdCanvas\"></canvas>\n\t\t\t<canvas style=\"width: 307px; height: 105px;position:fixed;top:99999999999999upx;\" canvas-id=\"carCandCanvas\"></canvas>\n\t\t</view>\n\t</view>\n</template>\n\n<script>\n// @ is an alias to /src\nimport uniPopup from '@/components/uni-popup/uni-popup.vue';\nimport bxform from '@/components/form.vue';\nexport default {\n\tname: 'idCardInfoCollect',\n\tcomponents: { uniPopup, bxform },\n\tdata() {\n\t\treturn {\n\t\t\taddType: '',\n\t\t\tshowCamera: true,\n\t\t\ttempFilePath: '',\n\t\t\tbeforeImg: '',\n\t\t\tpreviewImg: '',\n\t\t\tcompressImg: '', //压缩后的图片\n\t\t\tafterImg: '', //裁剪之后的图\n\t\t\tfileList: [],\n\t\t\tpicList: [],\n\t\t\tresponseList: [],\n\t\t\tdept_no: '',\n\t\t\tformData: {\n\t\t\t\tname: '',\n\t\t\t\tid_card_addr: '',\n\t\t\t\tid_card_no: '',\n\t\t\t\tprofile_picture: '',\n\t\t\t\tcar_photo: '',\n\t\t\t\tcar_no: ''\n\t\t\t},\n\t\t\tfromService: '',\n\t\t\tfieldMapping: {}\n\t\t};\n\t},\n\tonLoad(option) {\n\t\tif (option.fromService) {\n\t\t\tthis.fromService = option.fromService;\n\t\t}\n\t\tif (option.fieldMapping) {\n\t\t\ttry {\n\t\t\t\tthis.fieldMapping = JSON.parse(option.fieldMapping);\n\t\t\t\tthis.fieldMapping.cardImg = 'identity_image';\n\t\t\t\tthis.fieldMapping.avatar = '';\n\t\t\t\t// avatar:\"\",\n\t\t\t\t// cardImg:\"identity_image\"\n\t\t\t\t// idNo: \"identity_no\"\n\t\t\t\t// name: \"name\"\n\t\t\t\t// native: \"native_place\"\n\t\t\t\tObject.values(this.fieldMapping).forEach(item => {\n\t\t\t\t\tthis.formData[item] = '';\n\t\t\t\t});\n\t\t\t\tconsole.log('this.fieldMapping', this.fieldMapping);\n\t\t\t} catch (e) {\n\t\t\t\t//TODO handle the exception\n\t\t\t}\n\t\t}\n\t\tif (option.addType) {\n\t\t\tthis.addType = option.addType;\n\t\t} else {\n\t\t\tthis.addType = 'person';\n\t\t}\n\t},\n\tmethods: {\n\t\ttoForm() {\n\t\t\tconst formData = this.formData;\n\t\t\t// if (this.addType === 'car') {\n\t\t\t// \tuni.redirectTo({\n\t\t\t// \t\turl: '../checkInCarInfo/checkInCarInfo?formData=' + encodeURIComponent(JSON.stringify(formData)) + '&dept_no=' + this.dept_no\n\t\t\t// \t});\n\t\t\t// } else {\n\t\t\tconsole.log('formData-takephotos', formData);\n\t\t\tuni.redirectTo({\n\t\t\t\turl: '/pages/formPage/formPage?formData=' + encodeURIComponent(JSON.stringify(formData)) + '&type=add&serviceName=' + this.fromService\n\t\t\t});\n\t\t\t// }\n\t\t},\n\t\tgetPreviewPic() {\n\t\t\tlet that = this;\n\t\t\tlet path = this.beforeImg;\n\t\t\t// 将身份证照片转为canvas图像(缩放为375px*250px)\n\t\t\tconst uploadUrl = that.$api.upload;\n\t\t\tif (that.addType === 'car') {\n\t\t\t\tconst ctx0 = uni.createCanvasContext('previewCarCanvas', this);\n\t\t\t\t// 改变中心点carCandCanvas\n\t\t\t\t// ctx0.translate(0, 688);\n\t\t\t\t// 旋转270°\n\t\t\t\t// ctx0.rotate((270 * Math.PI) / 180);\n\t\t\t\t// ctx0.drawImage(path, 0, 0, 688, 1024);\n\t\t\t\tctx0.drawImage(path, 0, 0, 688, 1024);\n\t\t\t\tctx0.draw(false, function(e) {\n\t\t\t\t\tthat.fileList = [];\n\t\t\t\t\tthat.picList = [];\n\t\t\t\t\tthat.responseList = [];\n\t\t\t\t\tuni.canvasToTempFilePath({\n\t\t\t\t\t\tx: 0,\n\t\t\t\t\t\ty: 0,\n\t\t\t\t\t\twidth: 688,\n\t\t\t\t\t\theight: 1024,\n\t\t\t\t\t\t// width: 1024,\n\t\t\t\t\t\t// height: 688,\n\t\t\t\t\t\tdestWidth: 688,\n\t\t\t\t\t\tdestHeight: 1024,\n\t\t\t\t\t\tfileType: 'jpg',\n\t\t\t\t\t\tcanvasId: 'previewCarCanvas',\n\t\t\t\t\t\tsuccess: res => {\n\t\t\t\t\t\t\t// 车牌\n\t\t\t\t\t\t\tthat.previewImg = res.tempFilePath;\n\t\t\t\t\t\t\tconsole.log('car-preview', res.tempFilePath);\n\t\t\t\t\t\t\tuni.uploadFile({\n\t\t\t\t\t\t\t\turl: uploadUrl,\n\t\t\t\t\t\t\t\tfilePath: res.tempFilePath,\n\t\t\t\t\t\t\t\tname: 'file',\n\t\t\t\t\t\t\t\theader: {\n\t\t\t\t\t\t\t\t\tbx_auth_ticket: that.$api.onTicket ? that.$api.ticket : uni.getStorageSync('bx_auth_ticket')\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tformData: {\n\t\t\t\t\t\t\t\t\tserviceName: 'srv_bxfile_service',\n\t\t\t\t\t\t\t\t\tinterfaceName: 'add',\n\t\t\t\t\t\t\t\t\tapp_no: 'daq',\n\t\t\t\t\t\t\t\t\ttable_name: 'bxdaq_check_car',\n\t\t\t\t\t\t\t\t\tcolumns: 'car_photo'\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tsuccess: uploadFileRes => {\n\t\t\t\t\t\t\t\t\tconst data = JSON.parse(uploadFileRes.data);\n\t\t\t\t\t\t\t\t\tthat.formData.car_photo = data.file_no;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tconst ctx0 = uni.createCanvasContext('previewCanvas', this);\n\t\t\t\t// 改变中心点\n\t\t\t\tctx0.translate(0, 250);\n\t\t\t\t// 旋转270°\n\t\t\t\tctx0.rotate((270 * Math.PI) / 180);\n\t\t\t\tctx0.drawImage(path, 0, 0, 250, 375);\n\t\t\t\tctx0.draw(false, function(e) {\n\t\t\t\t\tthat.fileList = [];\n\t\t\t\t\tthat.picList = [];\n\t\t\t\t\tthat.responseList = [];\n\t\t\t\t\tuni.canvasToTempFilePath({\n\t\t\t\t\t\tx: 0,\n\t\t\t\t\t\ty: 0,\n\t\t\t\t\t\twidth: 375,\n\t\t\t\t\t\theight: 250,\n\t\t\t\t\t\tdestWidth: 375,\n\t\t\t\t\t\tdestHeight: 250,\n\t\t\t\t\t\tfileType: 'jpg',\n\t\t\t\t\t\tcanvasId: 'previewCanvas',\n\t\t\t\t\t\tsuccess: res => {\n\t\t\t\t\t\t\t// 身份证\n\t\t\t\t\t\t\tthat.previewImg = res.tempFilePath;\n\t\t\t\t\t\t\tconsole.log(that.previewImg);\n\t\t\t\t\t\t\tuni.uploadFile({\n\t\t\t\t\t\t\t\turl: uploadUrl,\n\t\t\t\t\t\t\t\tfilePath: res.tempFilePath,\n\t\t\t\t\t\t\t\tname: 'file',\n\t\t\t\t\t\t\t\theader: {\n\t\t\t\t\t\t\t\t\tbx_auth_ticket: that.$api.onTicket ? that.$api.ticket : uni.getStorageSync('bx_auth_ticket')\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tformData: {\n\t\t\t\t\t\t\t\t\tserviceName: 'srv_bxfile_service',\n\t\t\t\t\t\t\t\t\tinterfaceName: 'add',\n\t\t\t\t\t\t\t\t\tapp_no: 'daq',\n\t\t\t\t\t\t\t\t\ttable_name: '',\n\t\t\t\t\t\t\t\t\tcolumns: that.fieldMapping.file ? that.fieldMapping.file : ''\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tsuccess: uploadFileRes => {\n\t\t\t\t\t\t\t\t\tconst data = JSON.parse(uploadFileRes.data);\n\t\t\t\t\t\t\t\t\tthat.formData.id_card_photo = data.file_no;\n\t\t\t\t\t\t\t\t\tthat.formData[that.fieldMapping.cardImg] = data.file_no;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\tclipImages() {\n\t\t\tuni.showLoading({\n\t\t\t\ttitle: '正在识别...'\n\t\t\t});\n\t\t\t// 将身份证照片裁剪为姓名、住址、身份证三个canvas图像\n\t\t\tconst that = this;\n\t\t\tif (this.addType === 'person') {\n\t\t\t\tconst ctx = uni.createCanvasContext('firstCanvas', this);\n\t\t\t\tctx.drawImage(that.previewImg, 75, 35, 160, 45, 0, 0, 160, 45);\n\t\t\t\t// ctx.drawImage(that.previewImg, 60, 20, 160, 35, 0, 0, 160, 35);\n\t\t\t\tctx.draw(false, function(e) {\n\t\t\t\t\tconst attr = {\n\t\t\t\t\t\twidth: 160,\n\t\t\t\t\t\theight: 40,\n\t\t\t\t\t\tid: 'firstCanvas',\n\t\t\t\t\t\tlabel: 'name'\n\t\t\t\t\t};\n\t\t\t\t\tthat.getImg(attr);\n\t\t\t\t});\n\t\t\t\t// 头像\n\t\t\t\tconst ctx1 = uni.createCanvasContext('profileCanvas', that);\n\t\t\t\tctx1.drawImage(that.previewImg, 225, 35, 110, 145, 0, 0, 110, 145);\n\t\t\t\tctx1.draw(false, function(e) {\n\t\t\t\t\tconst attr = {\n\t\t\t\t\t\twidth: 110,\n\t\t\t\t\t\theight: 145,\n\t\t\t\t\t\tid: 'profileCanvas',\n\t\t\t\t\t\tlabel: 'avatar'\n\t\t\t\t\t};\n\t\t\t\t\tthat.getImg(attr);\n\t\t\t\t});\n\t\t\t\t// 住址\n\t\t\t\tconst ctx2 = uni.createCanvasContext('secondCanvas', that);\n\t\t\t\tctx2.drawImage(that.previewImg, 75, 110, 170, 70, 0, 0, 170, 70);\n\t\t\t\t// ctx2.drawImage(that.previewImg, 60, 110, 170, 70, 0, 0, 170, 70);\n\t\t\t\tctx2.draw(false, function(e) {\n\t\t\t\t\tconst attr = {\n\t\t\t\t\t\twidth: 170,\n\t\t\t\t\t\theight: 70,\n\t\t\t\t\t\tid: 'secondCanvas',\n\t\t\t\t\t\tlabel: 'native'\n\t\t\t\t\t};\n\t\t\t\t\tthat.getImg(attr);\n\t\t\t\t});\n\t\t\t\t// 身份证号\n\t\t\t\tconst ctx3 = uni.createCanvasContext('thirdCanvas', that);\n\t\t\t\tctx3.drawImage(that.previewImg, 130, 160, 235, 70, 0, 0, 235, 70);\n\t\t\t\tctx3.draw(false, function(e) {\n\t\t\t\t\tconst attr = {\n\t\t\t\t\t\twidth: 235,\n\t\t\t\t\t\theight: 40,\n\t\t\t\t\t\tid: 'thirdCanvas',\n\t\t\t\t\t\tlabel: 'idNo'\n\t\t\t\t\t};\n\n\t\t\t\t\tthat.getImg(attr);\n\t\t\t\t});\n\t\t\t} else if (this.addType === 'car') {\n\t\t\t\tconst ctx = uni.createCanvasContext('carCandCanvas', this);\n\t\t\t\tctx.drawImage(that.previewImg, 190, 637, 317, 107, 0, 0, 318, 107);\n\t\t\t\t// ctx.drawImage(that.previewImg, 354, 433, 307, 105, 0, 0, 307, 105);\n\t\t\t\tctx.draw(false, function(e) {\n\t\t\t\t\tconst attr = {\n\t\t\t\t\t\twidth: 307,\n\t\t\t\t\t\theight: 105,\n\t\t\t\t\t\tid: 'carCandCanvas',\n\t\t\t\t\t\tlabel: 'car_no'\n\t\t\t\t\t};\n\t\t\t\t\tthat.getImg(attr);\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\tgetImg(canvasData) {\n\t\t\t// 将canvas图像转换成png格式图片\n\t\t\tconst that = this;\n\t\t\tuni.canvasToTempFilePath({\n\t\t\t\tx: 0,\n\t\t\t\ty: 0,\n\t\t\t\twidth: canvasData.width,\n\t\t\t\theight: canvasData.height,\n\t\t\t\tdestWidth: canvasData.width,\n\t\t\t\tdestHeight: canvasData.height,\n\t\t\t\tcanvasId: canvasData.id,\n\t\t\t\tsuccess: res => {\n\t\t\t\t\tthat.picList.push(res.tempFilePath);\n\t\t\t\t\tconst uploadUrl = that.$api.upload;\n\t\t\t\t\tconsole.log(res.tempFilePath);\n\t\t\t\t\tuni.uploadFile({\n\t\t\t\t\t\turl: uploadUrl,\n\t\t\t\t\t\tfilePath: res.tempFilePath,\n\t\t\t\t\t\tname: 'file',\n\t\t\t\t\t\theader: {\n\t\t\t\t\t\t\tbx_auth_ticket: that.$api.onTicket ? that.$api.ticket : uni.getStorageSync('bx_auth_ticket')\n\t\t\t\t\t\t},\n\t\t\t\t\t\tformData: {\n\t\t\t\t\t\t\tserviceName: 'srv_bxfile_service',\n\t\t\t\t\t\t\tinterfaceName: 'add',\n\t\t\t\t\t\t\tapp_no: 'daq',\n\t\t\t\t\t\t\ttable_name: '',\n\t\t\t\t\t\t\tcolumns: ''\n\t\t\t\t\t\t},\n\t\t\t\t\t\tsuccess: uploadFileRes => {\n\t\t\t\t\t\t\t// 图片上传成功后的回调\n\t\t\t\t\t\t\tconst data = JSON.parse(uploadFileRes.data);\n\t\t\t\t\t\t\tif (canvasData.label === 'profile_picture') {\n\t\t\t\t\t\t\t\tconsole.log('profile_picture', data);\n\t\t\t\t\t\t\t\tconsole.log(res.tempFilePath);\n\t\t\t\t\t\t\t\tthat.formData.profile_picture = data.file_no;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tthat.fileList.push(data.file_no);\n\t\t\t\t\t\t\t\tthat.responseList.push({\n\t\t\t\t\t\t\t\t\tfile_no: data.file_no,\n\t\t\t\t\t\t\t\t\tlabel: canvasData.label,\n\t\t\t\t\t\t\t\t\tcontent: ''\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\tconst reqUrl = that.getServiceUrl('daq', 'srvdaq_orc_text_extraction', 'operate');\n\t\t\t\t\t\t\t\tconst reqData = [\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tserviceName: 'srvdaq_orc_text_extraction',\n\t\t\t\t\t\t\t\t\t\tdata: [\n\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\tfile_no: data.file_no\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t];\n\t\t\t\t\t\t\t\tthat.$http.post(reqUrl, reqData).then(response => {\n\t\t\t\t\t\t\t\t\t// 得到识别的文字\n\t\t\t\t\t\t\t\t\tif (response.data.state === 'SUCCESS') {\n\t\t\t\t\t\t\t\t\t\tlet list = that.responseList;\n\t\t\t\t\t\t\t\t\t\tconst resp = response.data.response[0].response; // {file_no:text}\n\t\t\t\t\t\t\t\t\t\tif (resp) {\n\t\t\t\t\t\t\t\t\t\t\tconsole.log(\n\t\t\t\t\t\t\t\t\t\t\t\tlist,\n\t\t\t\t\t\t\t\t\t\t\t\t'list',\n\t\t\t\t\t\t\t\t\t\t\t\tthat.formData,\n\t\t\t\t\t\t\t\t\t\t\t\tthat.fieldMapping,\n\t\t\t\t\t\t\t\t\t\t\t\tthat.formData[that.fieldMapping.name],\n\t\t\t\t\t\t\t\t\t\t\t\tthat.formData[that.fieldMapping.native],\n\t\t\t\t\t\t\t\t\t\t\t\tthat.formData[that.fieldMapping.idNo]\n\t\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t\t\tlist.map(listItem => {\n\t\t\t\t\t\t\t\t\t\t\t\tif (resp[listItem.file_no]) {\n\t\t\t\t\t\t\t\t\t\t\t\t\tlistItem['value'] = resp[listItem.file_no];\n\t\t\t\t\t\t\t\t\t\t\t\t\tconsole.log(listItem);\n\t\t\t\t\t\t\t\t\t\t\t\t\tthat.$set(that.formData, canvasData.label, resp[listItem.file_no]);\n\t\t\t\t\t\t\t\t\t\t\t\t\tthat.$set(that.formData, that.fieldMapping[canvasData.label], resp[listItem.file_no]);\n\t\t\t\t\t\t\t\t\t\t\t\t\tconsole.log(that.formData, 'that.formData');\n\t\t\t\t\t\t\t\t\t\t\t\t\tuni.hideLoading();\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t\tconsole.log(response.data.response[0].response);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tconsole.log(response.data.response);\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tconsole.log(response.data.resultMessage);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\ttoCarema() {\n\t\t\tthis.formData = {\n\t\t\t\tname: '',\n\t\t\t\tid_card_addr: '',\n\t\t\t\tid_card_no: ''\n\t\t\t};\n\t\t\tthis.showCamera = true;\n\t\t},\n\t\ttakePhoto() {\n\t\t\tconst that = this;\n\t\t\t// this.showCanvas = true;\n\t\t\t// #ifdef H5\n\t\t\t// 从本地选择图片\n\t\t\tuni.chooseImage({\n\t\t\t\tcount: 1, //默认9\n\t\t\t\tsizeType: ['original'], //可以指定是原图还是压缩图，默认二者都有\n\t\t\t\tsourceType: ['album'], //从相册选择\n\t\t\t\tsuccess: function(res) {\n\t\t\t\t\tthat.beforeImg = res.tempFilePaths[0];\n\t\t\t\t\tthat.clipImages();\n\t\t\t\t}\n\t\t\t});\n\t\t\t// #endif\n\t\t\t// #ifdef APP-PLUS||MP-WEIXIN\n\t\t\t// 得到camera组件拍到的照片\n\t\t\tconst ctx = uni.createCameraContext();\n\t\t\tctx.takePhoto({\n\t\t\t\tquality: 'high',\n\t\t\t\tsuccess: res => {\n\t\t\t\t\t// 拍到的照片\n\t\t\t\t\tthis.beforeImg = res.tempImagePath;\n\t\t\t\t\tthis.showCamera = false;\n\t\t\t\t\t// this.clipImages();\n\t\t\t\t\tthis.getPreviewPic();\n\t\t\t\t}\n\t\t\t});\n\t\t\t// #endif\n\t\t},\n\t\terror(e) {\n\t\t\tconsole.log(e.detail);\n\t\t}\n\t}\n};\n</script>\n\n<style lang=\"scss\">\n.collect-wrap {\n\twidth: 100%;\n\theight: 100vh;\n\tdisplay: flex;\n\tflex-direction: column;\n\t.camera-wrap {\n\t\tbackground-color: #000;\n\t\twidth: 100%;\n\t\theight: 100%;\n\t\toverflow: auto;\n\t\tdisplay: flex;\n\t\tjustify-content: center;\n\t\tflex-direction: column;\n\t\talign-items: center;\n\t\t.collect-title {\n\t\t\twidth: 100%;\n\t\t\tcolor: #fff;\n\t\t\tbackground-color: #000;\n\t\t\tfont-size: 36upx;\n\t\t\tfont-weight: 600;\n\t\t\tline-height: 100upx;\n\t\t\ttext-align: center;\n\t\t}\n\t\t.scan-img {\n\t\t\topacity: 0.4;\n\t\t\twidth: 750upx;\n\t\t\theight: 1115upx;\n\t\t\tmargin: 0 auto;\n\t\t\t// padding: 30upx;\n\t\t}\n\t\t.take-photo-box {\n\t\t\twidth: 100%;\n\t\t\theight: 140upx;\n\t\t\tbackground-color: #000;\n\t\t\tdisplay: flex;\n\t\t\tjustify-content: center;\n\t\t\talign-items: center;\n\t\t\t.take-photo {\n\t\t\t\twidth: 100upx;\n\t\t\t\theight: 100upx;\n\t\t\t}\n\t\t}\n\t}\n\t.collect-box {\n\t\twidth: 100%;\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\t.image-box {\n\t\t\twidth: 750upx;\n\t\t\theight: 504upx;\n\t\t\t// width: 504upx;\n\t\t\t// height: 750upx;\n\t\t\ttext-align: center;\n\t\t\tposition: relative;\n\t\t\t.previewImg {\n\t\t\t\twidth: 750upx;\n\t\t\t\theight: 504upx;\n\t\t\t}\n\n\t\t\t.image {\n\t\t\t\twidth: 100%;\n\t\t\t\theight: 100%;\n\t\t\t\t&:first-child {\n\t\t\t\t\tz-index: 2;\n\t\t\t\t\tposition: absolute;\n\t\t\t\t\ttop: 0;\n\t\t\t\t}\n\t\t\t\t&:last-child {\n\t\t\t\t\tz-index: 1;\n\t\t\t\t}\n\t\t\t}\n\t\t\t.carPreviewImg {\n\t\t\t\twidth: 340upx;\n\t\t\t\theight: 504upx;\n\t\t\t\tleft: calc(50% - 170upx);\n\t\t\t}\n\t\t}\n\t\t.collect-button {\n\t\t\twidth: 100%;\n\t\t\tdisplay: flex;\n\t\t\tjustify-content: space-around;\n\t\t\talign-items: center;\n\t\t\theight: 150upx;\n\t\t}\n\t}\n}\n</style>\n","import mod from \"-!../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-2!../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./takePhotos.vue?vue&type=style&index=0&lang=scss&\"; export default mod; export * from \"-!../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-2!../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./takePhotos.vue?vue&type=style&index=0&lang=scss&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1596523855376\n      var cssReload = require(\"D:/Program Files/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"../../\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}