{"version":3,"sources":["webpack:///D:/user/Documents/HBuilderProjects/PovertySurvey/components/file-upload/file-upload.vue?dbd1","webpack:///D:/user/Documents/HBuilderProjects/PovertySurvey/components/file-upload/file-upload.vue?bf12","webpack:///D:/user/Documents/HBuilderProjects/PovertySurvey/components/file-upload/file-upload.vue?bc21","webpack:///D:/user/Documents/HBuilderProjects/PovertySurvey/components/file-upload/file-upload.vue?bdd4","uni-app:///components/file-upload/file-upload.vue","webpack:///D:/user/Documents/HBuilderProjects/PovertySurvey/components/file-upload/file-upload.vue?c80f","webpack:///D:/user/Documents/HBuilderProjects/PovertySurvey/components/file-upload/file-upload.vue?29cb"],"names":[],"mappings":";;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAoI;AACpI;AAC+D;AACL;AACsC;;;AAGhG;AACuL;AACvL,gBAAgB,2LAAU;AAC1B,EAAE,iFAAM;AACR,EAAE,kGAAM;AACR,EAAE,2GAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,sGAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACRA;AAAA;AAAA;AAAA;AAA4sB,CAAgB,2rBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACgBhuB;AACA,kG;;;;;;;;;;;;;;;gBACA,EACA,IADA,kBACA,CACA,SACA,YADA,EAEA,YAFA,EAGA,eAHA,GAKA,CAPA,EAQA,SACA,WACA,YADA,EAEA,+BAFA,EADA,EARA,EAcA,0BAdA;AAeA;AACA,cADA,wBACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAhBA;AAiBA;AACA;AACA,KA1BA;AA2BA,cA3BA,sBA2BA,KA3BA,EA2BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAJA,MAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kEADA,EADA;;AAIA,kCAJA;AAKA,sBALA;AAMA;AACA,kEADA;AAEA,+CAFA;AAGA,kCAHA;AAIA,qDAJA,EANA;;AAYA,4BAZA;AAaA,oCAbA;AAcA;AACA;AACA,aAhBA;AAiBA;AACA;AACA,aAnBA;AAoBA;AACA;AACA,aAtBA;;AAwBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KArFA;AAsFA,WAtFA,mBAsFA,IAtFA,EAsFA;AACA;AACA;AACA;AACA;AACA;AACA,OAHA;AAIA;AACA,KA9FA;AA+FA,kBA/FA,0BA+FA,CA/FA,EA+FA,IA/FA,EA+FA;AACA;AACA;AACA;AACA,KAnGA;AAoGA,iBApGA,yBAoGA,GApGA,EAoGA,IApGA,EAoGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KApHA;AAqHA,eArHA,uBAqHA,GArHA,EAqHA,QArHA,EAqHA,IArHA,EAqHA;AACA;AACA;AACA;AACA;AACA;AACA,KA3HA;AA4HA,gBA5HA,wBA4HA,IA5HA,EA4HA;AACA;AACA;AACA;AACA,KAhIA;AAiIA,iBAjIA,yBAiIA,IAjIA,EAiIA;AACA;AACA;AACA;AACA,KArIA,EAfA,E;;;;;;;;;;;;;AClBA;AAAA;AAAA;AAAA;AAAyzC,CAAgB,qtCAAG,EAAC,C;;;;;;;;;;;ACA70C;AACA,OAAO,KAAU,EAAE,kBAKd","file":"components/file-upload/file-upload.js","sourcesContent":["import { render, staticRenderFns, recyclableRender, components } from \"./file-upload.vue?vue&type=template&id=520d372c&scoped=true&\"\nvar renderjs\nimport script from \"./file-upload.vue?vue&type=script&lang=js&\"\nexport * from \"./file-upload.vue?vue&type=script&lang=js&\"\nimport style0 from \"./file-upload.vue?vue&type=style&index=0&id=520d372c&scoped=true&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"520d372c\",\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"components/file-upload/file-upload.vue\"\nexport default component.exports","export * from \"-!../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--16-0!../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./file-upload.vue?vue&type=template&id=520d372c&scoped=true&\"","var components\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./file-upload.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./file-upload.vue?vue&type=script&lang=js&\"","<template>\r\n  <view class=\"file-upload\">\r\n    <view ref=\"input\" class=\"input\"></view>\r\n    <view class=\"addNew\" @click=\"chooseFile\" v-if=\"fileResList.length<1\"><text class=\"cuIcon-add\"></text></view>\r\n    <view class=\"\"><text ref=\"fileTip\" id=\"fileTip\"></text></view>\r\n    <view class=\"file-list\">\r\n      <view class=\"file-list-item\" v-for=\"(item,index) in fileResList\" :key=\"index\">\r\n        <view class=\"file-info\" v-if=\"item.src_name\">\r\n          {{item.src_name}}\r\n        </view>\r\n      </view>\r\n    </view>\r\n  </view>\r\n</template>\r\n\r\n<script>\r\nimport ajax from '@/common/ajax.js';\r\nimport Emitter from '@/common/mixins/emitter.js';\r\nexport default {\r\n  data() {\r\n    return {\r\n      fileList: [],\r\n      fileInfo:{},\r\n      fileResList:[]\r\n    };\r\n  },\r\n  props: {\r\n    srvInfo: {\r\n      type: Object,\r\n      default: () => {}\r\n    }\r\n  },\r\n  mixins: [Emitter],\r\n  methods: {\r\n    chooseFile() {\r\n      const self = this;\r\n      let fileTip = document.getElementById('fileTip');\r\n      var input = document.createElement('input');\r\n      input.style = 'display:none';\r\n      input.type = 'file';\r\n      input.onchange = event => {\r\n        self.fileChange(event);\r\n\r\n        // const files = event.target.files\r\n        // if (files && files[0]) {\r\n        //   const file = files[0];\r\n        //   if (file.size > 1024 * 1024 * 10) {\r\n        //     fileTip.innerHTML = '文件大小不能超过10M!';\r\n        //     input.value = '';\r\n        //     return false;\r\n        //   } else {\r\n        //     fileTip.innerHTML = '';\r\n        //     console.log(file)\r\n        //     formData.append('file', file);\r\n        //   }\r\n        // }\r\n      };\r\n      input.click();\r\n      // this.$refs.input.$el.appendChild(input);\r\n    },\r\n    fileChange(event) {\r\n      const self = this;\r\n      let formData = new FormData();\r\n      const files = event.target.files;\r\n      if (files && files[0]) {\r\n        const file = files[0];\r\n        self.fileList.push(file);\r\n        if (file.size > 1024 * 1024 * 10) {\r\n          fileTip.innerHTML = '文件大小不能超过10M!';\r\n          input.value = '';\r\n          return false;\r\n        } else {\r\n          fileTip.innerHTML = '';\r\n          // formData.append('file', file);\r\n          // formData.append('bx_auth_ticket', uni.getStorageSync('bx_auth_ticket'));\r\n          // formData.append('serviceName', 'srv_bxfile_service');\r\n          // formData.append('interfaceName', 'add');\r\n          // formData.append('app_no', uni.getStorageSync('activeApp'));\r\n          ajax({\r\n            headers: {\r\n              bx_auth_ticket: uni.getStorageSync('bx_auth_ticket')\r\n            },\r\n            withCredentials: false,\r\n            file: file,\r\n            data: {\r\n              bx_auth_ticket: uni.getStorageSync('bx_auth_ticket'),\r\n              serviceName: 'srv_bxfile_service',\r\n              interfaceName: 'add',\r\n              app_no: uni.getStorageSync('activeApp')\r\n            },\r\n            filename: 'file',\r\n            action: self.$api.upload,\r\n            onProgress: e => {\r\n              // self.handleProgress(e, file);\r\n            },\r\n            onSuccess: res => {\r\n              self.handleSuccess(res, file);\r\n            },\r\n            onError: (err, response) => {\r\n              // self.handleError(err, response, file);\r\n            }\r\n          });\r\n          // var xhr = new XMLHttpRequest();\r\n          // xhr.open('POST', self.$api.upload, true);\r\n          // xhr.setRequestHeader('bx_auth_ticket', uni.getStorageSync('bx_auth_ticket'));\r\n          // xhr.onreadystatechange = function() {\r\n          //   console.log(xhr.responseText)\r\n          //   if (xhr.readyState == 4) {\r\n          //     if (xhr.status == 200 || xhr.status == 304) {\r\n          //       console.log(xhr.responseText)\r\n          //       return xhr.responseText\r\n          //     }\r\n          //   }\r\n          // };\r\n          // xhr.send(formData);\r\n          // return xhr\r\n        }\r\n      }\r\n    },\r\n    getFile(file) {\r\n      const fileList = this.fileList;\r\n      let target;\r\n      fileList.every(item => {\r\n        target = file.uid === item.uid ? item : null;\r\n        return !target;\r\n      });\r\n      return target;\r\n    },\r\n    handleProgress(e, file) {\r\n      const _file = this.getFile(file);\r\n      this.onProgress(e, _file, this.fileList);\r\n      _file.percentage = e.percent || 0;\r\n    },\r\n    handleSuccess(res, file) {\r\n      const _file = this.getFile(file);\r\n      // this.fileList.push(_file)\r\n      if (_file) {\r\n        _file.status = 'finished';\r\n        _file.response = res;\r\n        // this.fileResList.push(res)\r\n        this.$set(this.fileResList,0,res)\r\n        this.fileInfo = res\r\n        this.$emit('add',_file)\r\n        // this.onSuccess(res, _file, this.fileList);\r\n        // this.dispatch('FormItem', 'on-form-change', _file);\r\n        // setTimeout(() => {\r\n        //   _file.showProgress = false;\r\n        // }, 1000);\r\n      }\r\n    },\r\n    handleError(err, response, file) {\r\n      const _file = this.getFile(file);\r\n      const fileList = this.fileList;\r\n      _file.status = 'fail';\r\n      fileList.splice(fileList.indexOf(_file), 1);\r\n      this.onError(err, response, file);\r\n    },\r\n    handleRemove(file) {\r\n      const fileList = this.fileList;\r\n      fileList.splice(fileList.indexOf(file), 1);\r\n      this.onRemove(file, fileList);\r\n    },\r\n    handlePreview(file) {\r\n      if (file.status === 'finished') {\r\n        this.onPreview(file);\r\n      }\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n.file-upload {\r\n  .addNew {\r\n    width: 125upx;\r\n    height: 150upx;\r\n    border: 1px solid #ccc;\r\n    display: flex;\r\n    justify-content: center;\r\n    align-items: center;\r\n    margin-top: 20upx;\r\n    margin-right: 12rpx;\r\n  }\r\n}\r\n</style>\r\n","import mod from \"-!../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-2!../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./file-upload.vue?vue&type=style&index=0&id=520d372c&scoped=true&lang=scss&\"; export default mod; export * from \"-!../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-2!../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./file-upload.vue?vue&type=style&index=0&id=520d372c&scoped=true&lang=scss&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1596453611143\n      var cssReload = require(\"D:/Program Files/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"../../\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}